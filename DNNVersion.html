<style type="text/css">
 a, a:hover, a:focus, a:active {
     text-decoration: none;
     color: inherit;
 }

#side-bar{
    background-color: dimgrey;
    border-radius:50px;
    color: #000000;
    padding: 25px 15px;
}

#playlist-box {
    background-color: dimgrey;
    border-radius:50px;
    padding: 25px 15px;
}

.social{
    font-size: 50px;
}
</style>
<script type="application/javascript">
class Playlist {

    constructor(playlstJSON){
        this.id = playlstJSON.id
        this.name = playlstJSON.name
        this.description = playlstJSON.description
        this.name  = playlstJSON.name
        this.curator = playlstJSON.curator
        this.email = playlstJSON.email
        this.location = playlstJSON.location
        this.genres_string = playlstJSON.genres_string
        this.followers = playlstJSON.followers
        this.songs = playlstJSON.songs
        this.spotify_playlist_page = playlstJSON.spotify_playlist_page
        this.description = playlstJSON.description
        this.website = playlstJSON.website
        this.facebook = playlstJSON.facebook
        this.twitter = playlstJSON.twitter
        this.instagram = playlstJSON.instagram
        this.youtube = playlstJSON.youtube
        this.reddit = playlstJSON.reddit
        this.patreon = playlstJSON.patreon
        this.sound_cloud = playlstJSON.sound_cloud
        this.submit_hub = playlstJSON.submit_hub
        this.linked_in = playlstJSON.linked_in
        this.submission_page = playlstJSON.submission_page
        Playlist.all.push(this)
    }

    renderPlaylist() {

        let playlistBox = `<div onClick="viewplaylist(${this.id})" data-toggle="modal" data-target="#largeModal" class="featured-boxes featured-boxes-style-8 col-md-4">
            <div class="featured-box featured-box-primary featured-box-text-left">
                <div class="box-content">
                    <h4>${this.name.substring(0,29)}...</h4>
                    <h6>CURATOR: ${this.curator}</h6>
                    <p style="margin-bottom: 0px;">Genres: ${this.genarateTags()}</p>
                    <p style="margin-bottom: 0px;"><strong>DESCRIPTION:</strong></p> <p style="margin-bottom: 0px;">${this.description.substring(0,100)}</p>
                    <p style="margin-bottom: 0px;"><em class="fas fa-user"></em> ${this.followers}&nbsp;<em class="fas fa-music"></em> ${this.songs}</p>
                    <br>
                </div>
            </div>
        </div>`

        let list = document.getElementById("playlist_list")
        //let newListItem = document.createElement("li")
        
        list.innerHTML += playlistBox 
        //list.appendChild(newListItem);
        //debugger
    }

    renderPlaylistFull() {
        resetSocialIcons()
        document.getElementById("largeModalLabel").innerHTML = this.name
        document.getElementById("curator-location").innerHTML = this.curator
        document.getElementById("location-location").innerHTML = this.location
        document.getElementById("genres-location").innerHTML = this.genarateTags()
        document.getElementById("followers-location").innerHTML = this.followers
        document.getElementById("songs-location").innerHTML = this.songs
        document.getElementById("description-location").innerHTML = this.description

        let facebookLocation = document.getElementById("facebook-location")
        this.facebook ? facebookLocation.setAttribute("href", this.facebook) : facebookLocation.remove()

        let instagramLocation = document.getElementById("instagram-location")
        this.instagrm ? instagramLocation.setAttribute("href", this.instagram) : instagramLocation.remove()

        let twitterLocation = document.getElementById("twitter-location")
        this.twitter ? twitterLocation.setAttribute("href", this.twitter) : twitterLocation.remove()

        let youtubeLocation = document.getElementById("youtube-location")
        this.youtube ? youtubeLocation.setAttribute("href", this.youtube) : youtubeLocation.remove()

        let soundcloudLocation = document.getElementById("soundcloud-location")
        this.sound_cloud ? soundcloudLocation.setAttribute("href", this.sound_cloud) : soundcloudLocation.remove()

        let linkedinLocation = document.getElementById("linkedin-location")
        this.linked_in ? linkedinLocation.setAttribute("href", this.linked_in) : linkedinLocation.remove()

        let spotifyLocation = document.getElementById("spotify-location")
        this.spotify_playlist_page ? spotifyLocation.setAttribute("href", this.spotify_playlist_page) : spotifyLocation.remove()

        let redditLocation = document.getElementById("reddit-location")
        this.reddit ? redditLocation.setAttribute("href", this.reddit) : redditLocation.remove()

        let patreonLocation = document.getElementById("patreon-location")
        this.patreon ? patreonLocation.setAttribute("href", this.patreon) : patreonLocation.remove()
    }

    genarateTags(){
        let genres = this.genres_string.split(", ")
        let tags = ""

        genres.forEach(function(item,index){
            tags += `<span class="badge badge-sm badge-primary">${item}</span>&nbsp;`
        })

        return tags
    }
    
}

Playlist.all = [] 

//and of playlist class-----------------------------------------------------------------

class Genre {
    constructor(genreJSON){
        this.name = genreJSON.name
        Genre.all.push(this)
    }

    renderGenre(){
        let genreBox = `<span class="badge badge-sm badge-primary">${this.name}</span>&nbsp;`
        let list = document.getElementById("genre-list")
        list.innerHTML += genreBox
    }
}

//end of Genre Class---------------------------------------------------------------------

const endpoint = "https://spotify-curator-list.herokuapp.com/playlist" 
const genresEndpoint = "https://spotify-curator-list.herokuapp.com/genre"
var page = 1
var pages = 0
var pageIncrament = 24
var current_playlist_range = [0, pageIncrament]

window.onload = function(){
    let search_button = document.getElementById("search_bar")

    search_button.addEventListener('click',function(){ 
        document.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
              searchGenre()
            }
        });
    })

    let nextButton = document.getElementById('next-button')
    nextButton.addEventListener('click',function(event){ 
        event.preventDefault()
        next25Playlists()
        
    })

    let prevButton = document.getElementById('prev-button')
    prevButton.addEventListener('click',function(event){ 
        event.preventDefault()
        prev25Playlists()
        
    })

    let nextButton2 = document.getElementById('next-button-2')
    nextButton2.addEventListener('click',function(event){ 
        event.preventDefault()
        next25Playlists()
        scrollToTop()
    })

    let prevButton2 = document.getElementById('prev-button-2')
    prevButton2.addEventListener('click',function(event){ 
        event.preventDefault()
        pref25Playlists()
        scrollToTop()
        
    })

    getPlaylists();
    getGenre();
};

function getPlaylists() {
    fetch(endpoint)
    .then (function(response) {
        return response.json()
    })
    .then(requests => {
        //debugger
        requests.forEach(request => {
            let newPlaylist = new Playlist(request)
            //debugger
        })
        renderPlaylistSlice(current_playlist_range[0],current_playlist_range[1]);
    })
};

function updatePageNumber(){
    let location = document.getElementById("page-number")
    let location2 = document.getElementById("page-number-2")
    location.innerHTML = `${page}/${pages}` 
    location2.innerHTML = `${page}/${pages}`

    let location3 = document.getElementById("playlist-number")
    let location4 = document.getElementById("playlist-number-2")

    location3.innerHTML = `Viewing ${current_playlist_range[0] + 1}-${current_playlist_range[1]} out of ${Playlist.all.length} playlists</em></p>`
    location4.innerHTML = `Viewing ${current_playlist_range[0] + 1}-${current_playlist_range[1]} out of ${Playlist.all.length} playlists</em></p>`        
}

function next25Playlists(){
    if (current_playlist_range[1] >= Playlist.all.length){

    } else if (current_playlist_range[1] + pageIncrament <= 0){
        renderPlaylistSlice(current_playlist_range[0] += pageIncrament, current_playlist_range[1] = Playlist.all.length)
        page = pages
        updatePageNumber()
    } else {
        renderPlaylistSlice(current_playlist_range[0] += pageIncrament,current_playlist_range[1] += pageIncrament )
        page += 1
        updatePageNumber()
    }
}

function prev25Playlists(){
    if (current_playlist_range[0] <= 0){

    } else if (current_playlist_range[0] - pageIncrament <= 0){
        renderPlaylistSlice(current_playlist_range[0] = 0, current_playlist_range[1] = pageIncrament )
        page = 1
        updatePageNumber()
    } else {
        renderPlaylistSlice(current_playlist_range[0] -= pageIncrament, current_playlist_range[1] -= pageIncrament ) 
        page -= 1 
        updatePageNumber()
    }
}

function renderPlaylistSlice(arg1,arg2){
    clearList()
    Playlist.all.slice(arg1, arg2).forEach( playlist => {
        playlist.renderPlaylist();
    })
    pages = Math.floor(Playlist.all.length/pageIncrament)
    updatePageNumber()
}

function clearList(){
    let list = document.getElementById("playlist_list")
    list.innerHTML = ""
}

function searchGenre(){
    Playlist.all = []
    let searchContent = document.getElementById("search_bar").value

    let genreEndPoint = filterEndpoint[0] + searchContent + filterEndpoint[1]

    fetch(genreEndPoint)
    .then (function(response) {
        return response.json()
    })
    .then(requests => {
        requests.forEach(request => {
            let newPlaylist = new Playlist(request)
        })
        current_playlist_range[0] = 0
        current_playlist_range[1] = 26
        
        renderPlaylistSlice(current_playlist_range[0],current_playlist_range[1]);
    })
}

function viewplaylist(playlistId){
    //debugger
    for (let i = 0; i < Playlist.all.length; i++) {
        if (Playlist.all[i].id === parseInt(playlistId)) { 
            Playlist.all[i].renderPlaylistFull()
            break;
        }
    }
}

function resetSocialIcons(){
    let location = document.getElementById("social-list")
    location.innerHTML = `
        <a id="facebook-location" target="_blank"><span id="facebook" class="social"><em class="fab fa-facebook"></em>&nbsp;</span></a>        
        <a id="twitter-location" target="_blank"><span id="twitter" class="social"><em class="fab fa-twitter"></em>&nbsp;</span></a>
        <a id="instagram-location" target="_blank"><span id="instagrm" class="social"><em class="fab fa-instagram"></em>&nbsp;</span></a>
        <a id="youtube-location" target="_blank"><span id="youtube" class="social"><em class="fab fa-youtube"></em>&nbsp;</span></a>
        <a id="soundcloud-location" target="_blank"><span id="soundcloud" class="social"><em class="fab fa-soundcloud"></em>&nbsp;</span></a>
        <a id="linkedin-location" target="_blank"><span id="linkedin" class="social"><em class="fab fa-linkedin"></em>&nbsp;</span></a>
        <a id="spotify-location" target="_blank"><span id="spotify" class="social"><em class="fab fa-spotify"></em>&nbsp;</span></a>
        <a id="reddit-location" target="_blank"><span id="reddit" class="social"><em class="fab fa-reddit"></em>&nbsp;</span></a>
        <a id="patreon-location" target="_blank"><span id="patreon" class="social"><em class="fab fa-patreon"></em>&nbsp;</span></a>`
}

function getGenre(){
    Genre.all = []

    fetch(genresEndpoint)
    .then (function(response) {
        return response.json()
    })
    .then(requests => {
        requests.forEach(request => {
            let newGenre = new Genre(request)
        })
        renderAllGenres()
    })
}

function renderAllGenres(){
    Genre.all.forEach( genre => {
        genre.renderGenre();
    })
}

function scrollToTop(){
    window.scrollTo(0, 0)
} 

</script>

<div id="body">
    <button class="btn btn-primary" data-toggle="modal" data-target="#largeModal">
        Launch Large Modal
    </button>
    <div class="modal fade" id="largeModal" tabindex="-1" role="dialog" aria-labelledby="largeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="largeModalLabel">Large Modal Title</h4>&nbsp;<p><em class="fas fa-user"></em><span id="followers-location"></span>&nbsp;<em class="fas fa-music"></em><span id="songs-location"></span></p>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 0px;"><span id="genres-location"></span></p>
                    <p style="margin-bottom: 0px;"><strong>DESCRIPTION:</strong></p> <p id="description-location" style="margin-bottom: 0px;"></p>
                    <h6>CURATOR: <em><span id="curator-location"></span></em></h6>
                    <p><em><span id="email-location"></span></em></p>
                    <p><em><span id="location-location"></span></em></p>
                    <div id="social-list" class="center">
                        <a style="color:blue;" id="facebook-location" target="_blank"><span id="facebook" class="social"><em class="fab fa-facebook"></em>&nbsp;</span></a>
                        <a style="color:blue; id="twitter-location" target="_blank"><span id="twitter" class="social"><em class="fab fa-twitter"></em>&nbsp;</span></a>
                        <a style="color:blue; id="instagram-location" target="_blank"><span id="instagrm" class="social"><em class="fab fa-instagram"></em>&nbsp;</span></a>
                        <a style="color:blue; id="youtube-location" target="_blank"><span id="youtube" class="social"><em class="fab fa-youtube"></em>&nbsp;</span></a>
                        <a style="color:blue; id="soundscloud-location" target="_blank"><span id="soundcloud" class="social"><em class="fab fa-soundcloud"></em>&nbsp;</span></a>
                        <a style="color:blue; id="linkedin-location" target="_blank"><span id="linkedin" class="social"><em class="fab fa-linkedin"></em>&nbsp;</span></a>
                        <a style="color:blue; id="spotify-location" target="_blank"><span id="spotify" class="social"><em class="fab fa-spotify"></em>&nbsp;</span></a>
                        <a style="color:blue; id="reddit-location" target="_blank"><span id="reddit" class="social"><em class="fab fa-reddit"></em>&nbsp;</span></a>
                        <a style="color:blue; id="patreon-location" target="_blank"><span id="patreon" class="social"><em class="fab fa-patreon"></em>&nbsp;</span></a>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                        </div>
                        <div class="col-md-6">
                            <p id="website-location"></p>
                            <p id="submit_hub-location"></p>
                            <p id="submission_page-location"></p>
                        </div>
                    </div>
                    
                    <br>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
<div class="row">
<div class="col-md-1"> </div>

<div class="col-md-2">
<div id="side-bar">
<h3><strong>Filter</strong></h3>

<div>SEARCH:<input id="search_bar" name="search_bar" type="text" /></div>

<div>VIEW ALL</div>

<div id="genre-list"> </div>
</div>
</div>

<div class="col-md-8">
<div id="playlist-box">
<div id="top-nav">
<div class="center">
    <p><em id="playlist-number">Viewing 0-0 out of 0 playlists</em></p>
    <a class="btn btn-3d btn-primary mr-xs mb-sm" id="prev-button">&lt;</a> <strong><span id="page-number" style="color: #000;">1/0</span></strong> <a class="btn btn-3d btn-primary mr-xs mb-sm" id="next-button">&gt;</a></div>
</div>

<div class="row" id="playlist_list" style="overflow: hidden;"><em class="fas fa-sync-alt"></em></div>

<div id="bottom-nav">
<div class="center"><a class="btn btn-3d btn-primary mr-xs mb-sm" id="prev-button-2">&lt;</a> <strong><span id="page-number-2" style="color: #000;">1/0</span></strong> <a class="btn btn-3d btn-primary mr-xs mb-sm" id="next-button-2">&gt;</a>

<p><em id="playlist-number-2">Viewing 0-0 out of 0 playlists</em></p>
</div>
</div>
</div>
</div>

<div class="col-md-1"> </div>
</div>
</div>
